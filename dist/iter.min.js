/*! iter 2015-03-18 */
!function(global){"use strict";var isArray=function(value){return value&&Array.isArray(value)},isString=function(value){return"string"==typeof value},isFunction=function(value){return value&&"function"==typeof value},isObject=function(value){return value&&"object"==typeof value},bindContext=function(func,$this){return void 0===$this?func:func.bind($this)},toArray=function(args){return Array.prototype.slice.call(args)},IDENTITY_FUNCTION=function(x){return x},ALWAYS_TRUE_PREDICATE=function(){return!0},isJSIdentifier=function(){var ASCII_JS_IDENTIFIER_REGEX=/^[$a-z_][$a-z0-9_]*$/i;return function(value){return value&&isString(value)&&ASCII_JS_IDENTIFIER_REGEX.test(value)}}(),QUICK_RESULT={BOOL:"bool",VOID:"void",ANY:"any"},quickToFunction=function(expression,options){try{options=options||{};var body,parameters=options.parameters||["$","$index"];switch(options.result){case QUICK_RESULT.BOOL:body="return Boolean("+expression+");";break;case QUICK_RESULT.VOID:body=expression+"; return;";break;default:body="return ("+expression+");"}return Function.apply(null,parameters.concat([body]))}catch(ex){var error=new Error('Attempt to create function from expression "'+expression+'" failed. See $details property for original exception.');throw error.$details=ex,error}},isPropertySelector=function(value){return void 0!==value},createPropertySelectorFunction=function(propertyName){return function($){return $[propertyName]}},isPropertyMultiselector=function(obj){if(!isArray(obj))return!1;for(var i=0;i<obj.length;i+=1)if(!isPropertySelector(obj[i]))return!1;return!0},createPropertyMultiselectorFunciton=function(propertyNames){return function($){for(var result={},i=0;i<propertyNames.length;i+=1)result[propertyNames[i]]=$[propertyNames[i]];return result}},isQuick=function(value){return value&&isString(value)},throwIfNotQuickOrFunction=function(argValue,argName,funcName){if(!argValue||!isString(argValue)&&!isFunction(argValue))throw new Error("Invalid value of iter."+funcName+"() argument "+argName+". Valid values are quick expressions and functions")},extend=function(){for(var args=toArray(arguments),result={},i=0;i<args.length;i+=1){var ithObject=args[i];for(var prop in ithObject)Object.prototype.hasOwnProperty.call(ithObject,prop)&&(result[prop]=ithObject[prop])}return result},ArrayKeyHashtable=function(){var ArrayKeyHashtable=function(){this.items=Object.create(null)},computeHash=function(key){return key.join("#")},keysEqual=function(leftKey,rightKey){if(leftKey.length!==rightKey.length)return!1;for(var i=0;i<leftKey.length;i+=1)if(leftKey[i]!==rightKey[i])return!1;return!0},getCollisionList=function(hashtable,key,options){if(!isArray(key))throw new TypeError("key must be array of primitives.");var items=hashtable.items,hash=computeHash(key),collisionList=items[hash+"$"];return!collisionList&&options&&options.insertIfNotExist&&(items[hash+"$"]=collisionList=[]),collisionList},getObjectWithKey=function(collisionList,key){for(var i=0;i<collisionList.length;i+=1)if(keysEqual(collisionList[i].key,key))return collisionList[i];return null};ArrayKeyHashtable.prototype.put=function(key,value){var collisionList=getCollisionList(this,key,{insertIfNotExist:!0}),obj=getObjectWithKey(collisionList,key);obj?obj.value=value:collisionList.push({key:key,value:value})};var internalGet=function(hashtable,key){var collisionList=getCollisionList(hashtable,key,{insertIfNotExist:!1});return collisionList?getObjectWithKey(collisionList,key):null};return ArrayKeyHashtable.prototype.get=function(key){var obj=internalGet(this,key);return obj?obj.value:void 0},ArrayKeyHashtable.prototype.contains=function(key){return null!==internalGet(this,key)},ArrayKeyHashtable.prototype.toArray=function(){var result=[],items=this.items,hasOwnProperty={}.hasOwnProperty;for(var hash in items)if(hasOwnProperty.call(items,hash))for(var collisionList=items[hash],i=0;i<collisionList.length;i+=1)result.push({key:collisionList[i].key,value:collisionList[i].value});return result},ArrayKeyHashtable}(),ArrayIterator=function($array){this.$$index=-1,this.$$array=$array};ArrayIterator.prototype.next=function(){var incIndex=this.$$index+1;return incIndex<this.$$array.length?(this.$$index=incIndex,!0):!1},ArrayIterator.prototype.current=function(){if(-1===this.$$index)throw new Error("Call next() before current().");return this.$$array[this.$$index]},ArrayIterator.prototype.getUnderlyingArray=function(){return this.$$array};var ObjectIterator=function($object){this.$$index=-1,this.$$keys=Object.keys($object),this.$$object=$object};ObjectIterator.prototype.next=function(){for(var i=this.$$index+1,keys=this.$$keys,obj=this.$$object;i<keys.length;){if(Object.prototype.hasOwnProperty.call(obj,keys[i])){this.$$index=i;break}i+=1}return i<keys.length},ObjectIterator.prototype.current=function(){if(-1===this.$$index)throw new Error("call next() before current()");var key=this.$$keys[this.$$index],value=this.$$object[key];return{key:key,value:value}};var FunctionIterator=function($func){this.$$func=$func};FunctionIterator.prototype.next=function(){try{var newCurrent=this.$$func();return void 0!==newCurrent?(this.$$current=newCurrent,!0):!1}catch(ex){var error=new Error("Function thrown exception ($details property contains original exception).");throw error.$details=ex,error}},FunctionIterator.prototype.current=function(){if(void 0===this.$$current)throw new Error("Call next() before current().");return this.$$current};var Iterable=function(iteratorFunction){if(!iteratorFunction||!isFunction(iteratorFunction))throw new Error("iter.Iterable: iteratorFunction must be a function.");this.iterator=iteratorFunction},STANDARD_FUNCTION_OPTIONS_DEFAULTS={funcResult:QUICK_RESULT.BOOL,funcParams:null},standardFunction=function(options,callback){options=extend({},STANDARD_FUNCTION_OPTIONS_DEFAULTS,options);var func=options.func,context=options.context,iterable=options.iterable;return throwIfNotQuickOrFunction(func,options.funcArgName,options.methodName),isQuick(func)&&(func=quickToFunction(func,{result:options.funcResult,parameters:options.funcParams})),func=bindContext(func,context),callback(func,iterable)};Iterable.prototype.forEach=function(func,$this){var options={func:func,funcResult:QUICK_RESULT.VOID,context:$this,funcArgName:"func",methodName:"forEach",iterable:this};standardFunction(options,function(func,iterable){for(var it=iterable.iterator(),index=0;it.next();)func(it.current(),index),index+=1})},Iterable.prototype.isEmpty=function(){var it=this.iterator();return Boolean(it.next())===!1};var SOME_DEFAULT_PRED=function(x){return x};Iterable.prototype.some=function(pred,$this){var options={func:void 0===pred?SOME_DEFAULT_PRED:pred,context:$this,funcArgName:"pred",methodName:"some",iterable:this};return standardFunction(options,function(pred,iterable){for(var it=iterable.iterator(),index=0;it.next();){if(pred(it.current(),index))return!0;index+=1}return!1})};var EVERY_DEFAULT_PRED=function(x){return x};Iterable.prototype.every=function(pred,$this){var options={func:void 0===pred?EVERY_DEFAULT_PRED:pred,context:$this,funcArgName:"pred",methodName:"every",iterable:this};return standardFunction(options,function(pred,iterable){for(var it=iterable.iterator(),index=0;it.next();){if(!pred(it.current(),index))return!1;index+=1}return!0})},Iterable.prototype.and=function(){for(var it=this.iterator(),curr=!0;it.next()&&(curr=it.current()););return curr},Iterable.prototype.or=function(){for(var it=this.iterator(),curr=!1;it.next()&&!(curr=it.current()););return curr},Iterable.prototype.count=function(predOpt,$this){var it=null;it=predOpt?this.filter(predOpt,$this).iterator():this.iterator();for(var count=0;it.next();)count+=1;return count};var iteratorToArray=function(it){for(var result=[];it.next();)result.push(it.current());return result};Iterable.prototype.toArray=function(){var it=this.iterator();return iteratorToArray(it)};var FilterIterator=function($iterator,$pred){this.$$iterator=$iterator,this.$$pred=$pred,this.$$index=-1};FilterIterator.prototype.next=function(){for(;this.$$iterator.next();)if(this.$$index+=1,this.$$pred(this.$$iterator.current(),this.$$index))return!0;return!1},FilterIterator.prototype.current=function(){return this.$$iterator.current()},Iterable.prototype.filter=function(pred,$this){var options={func:pred,context:$this,funcArgName:"pred",methodName:"filter",iterable:this};return standardFunction(options,function(pred,iterable){return new Iterable(function(){var it=iterable.iterator();return new FilterIterator(it,pred)})})};var MapIterator=function($iterator,$map){this.$$iterator=$iterator,this.$$map=$map,this.$$index=-1,this.$$evaluated=!1};MapIterator.prototype.next=function(){return this.$$iterator.next()?(this.$$cache=void 0,this.$$evaluated=!1,this.$$index+=1,!0):!1},MapIterator.prototype.current=function(){return this.$$evaluated||(this.$$cache=this.$$map(this.$$iterator.current(),this.$$index),this.$$evaluated=!0),this.$$cache},Iterable.prototype.map=function(map,$this){var options={func:map,funcResult:QUICK_RESULT.ANY,context:$this,funcArgName:"map",methodName:"map",iterable:this};return standardFunction(options,function(map,iterable){return new Iterable(function(){var it=iterable.iterator();return new MapIterator(it,map)})})},Iterable.prototype.select=function(){var args=toArray(arguments);if(0===args.length)throw new Error("iter.select: No properties to select passed to select() call.");var mapFunc;if(args.length>1&&isPropertyMultiselector(args))mapFunc=createPropertyMultiselectorFunciton(args);else{if(1!==args.length||!isPropertySelector(args[0]))throw new Error('iter.select: Invalid argument, select() only accept property name(s). To select single property use select("propertyName") syntax, to select multiple properties use select("prop1", "prop2", "prop3") syntax.');mapFunc=createPropertySelectorFunction(args[0])}return this.map(mapFunc)},Iterable.prototype.reduce=function(seed,operation,$this){if(void 0===seed)throw new Error('iter.reduce: missing required argument "seed". Use iter.reduce1() to perform reduce without having to specify seed.');var options={func:operation,funcResult:QUICK_RESULT.ANY,funcParams:["$acc","$","$index"],context:$this,funcArgName:"operation",methodName:"reduce",iterable:this};return standardFunction(options,function(operation,iterable){for(var it=iterable.iterator(),acc=seed,index=0;it.next();)acc=operation(acc,it.current(),index),index+=1;return acc})},Iterable.prototype.reduce1=function(operation,$this){var options={func:operation,funcResult:QUICK_RESULT.ANY,funcParams:["$acc","$","$index"],context:$this,funcArgName:"operation",methodName:"reduce1",iterable:this};return standardFunction(options,function(operation,iterable){var it=iterable.iterator();if(!it.next())throw new Error("iter.reduce1: sequence contains no elements.");for(var acc=it.current(),index=1;it.next();)acc=operation(acc,it.current(),index),index+=1;return acc})},Iterable.prototype.sum=function(selector,$this){var options={func:void 0===selector?IDENTITY_FUNCTION:selector,funcResult:QUICK_RESULT.ANY,context:$this,funcArgName:"selector",methodName:"sum",iterable:this};return standardFunction(options,function(selector,iterable){for(var it=iterable.iterator(),index=0,sum=0;it.next();){var tmp=selector(it.current(),index);sum+=Number(tmp),index+=1}return sum})},Iterable.prototype.product=function(selector,$this){var options={func:void 0===selector?IDENTITY_FUNCTION:selector,funcResult:QUICK_RESULT.ANY,context:$this,funcArgName:"selector",methodName:"product",iterable:this};return standardFunction(options,function(selector,iterable){for(var it=iterable.iterator(),index=0,prod=1;it.next();){var tmp=selector(it.current(),index);prod*=Number(tmp),index+=1}return prod})},Iterable.prototype.avg=function(selector,$this){var options={func:void 0===selector?IDENTITY_FUNCTION:selector,funcResult:QUICK_RESULT.ANY,context:$this,funcArgName:"selector",methodName:"avg",iterable:this};return standardFunction(options,function(selector,iterable){for(var it=iterable.iterator(),n=0,sum=0;it.next();){var tmp=selector(it.current(),n);n+=1,sum+=Number(tmp)}return 0===n?0/0:sum/n})},Iterable.prototype.skip=function(){var SkipIterator=function($iterator,$skip){this.$$iterator=$iterator,this.$$skip=$skip};return SkipIterator.prototype.next=function(){for(;this.$$iterator.next();){if(0===this.$$skip)return!0;this.$$skip-=1}return!1},SkipIterator.prototype.current=function(){return this.$$iterator.current()},function(count){count=Number(count);var that=this;if(!isFinite(count))throw new Error("iter.skip: invalid argument value.");return count=0>count?0:count,new Iterable(function(){var it=that.iterator();return new SkipIterator(it,count)})}}(),Iterable.prototype.skipWhile=function(){var SkipWhileIterator=function($iterator,$pred){this.$$iterator=$iterator,this.$$pred=$pred,this.$$index=-1,this.$$skipEnded=!1};return SkipWhileIterator.prototype.next=function(){for(;this.$$iterator.next();){this.$$index+=1;var curr=this.$$iterator.current(),index=this.$$index;if(this.$$skipEnded||!this.$$pred(curr,index))return this.$$skipEnded=!0,!0}return!1},SkipWhileIterator.prototype.current=function(){return this.$$iterator.current()},function(pred,$this){var options={func:pred,context:$this,funcArgName:"pred",methodName:"skipWhile",iterable:this};return standardFunction(options,function(pred,iterable){return new Iterable(function(){var it=iterable.iterator();return new SkipWhileIterator(it,pred)})})}}(),Iterable.prototype.take=function(){var TakeIterator=function($iterator,$take){this.$$iterator=$iterator,this.$$take=$take};return TakeIterator.prototype.next=function(){return 0===this.$$take?!1:this.$$iterator.next()?(this.$$take-=1,!0):!1},TakeIterator.prototype.current=function(){return this.$$iterator.current()},function(count){count=Number(count);var that=this;if(!isFinite(count))throw new Error("iter.take: invalid argument value.");return count=0>count?0:count,new Iterable(function(){var it=that.iterator();return new TakeIterator(it,count)})}}(),Iterable.prototype.takeWhile=function(){var TakeWhileIterator=function($iterator,$pred){this.$$iterator=$iterator,this.$$pred=$pred,this.$$ended=!1,this.$$index=-1};return TakeWhileIterator.prototype.next=function(){if(this.$$ended)return!1;if(this.$$iterator.next()){this.$$index+=1;var curr=this.$$iterator.current(),index=this.$$index;return this.$$pred(curr,index)?(this.$$current={value:curr},!0):(this.$$ended=!0,!1)}return this.$$ended=!0,!1},TakeWhileIterator.prototype.current=function(){if(!this.$$current)throw new Error("iter.Iterator: this function can be called only when previous call to next() returns true.");return this.$$current.value},function(pred,$this){var options={func:pred,context:$this,funcArgName:"pred",methodName:"takeWhile",iterable:this};return standardFunction(options,function(pred,iterable){return new Iterable(function(){var it=iterable.iterator();return new TakeWhileIterator(it,pred)})})}}(),Iterable.prototype.join=function(separator){var array=this.toArray();return array.join(separator)},Iterable.prototype.sort=function(comparer,$this){if(void 0!==comparer){if(!isFunction(comparer))throw new TypeError("iter.sort: comparer must be a function.");comparer=bindContext(comparer,$this)}var that=this;return new Iterable(function(){var data=that.toArray();return comparer?data.sort(comparer):data.sort(),new ArrayIterator(data)})};var BackwardArrayIterator=function($array){this.$$index=$array.length,this.$$arrayLength=$array.length,this.$$array=$array};BackwardArrayIterator.prototype.next=function(){var decIndex=this.$$index-1;return decIndex>=0?(this.$$index=decIndex,!0):!1},BackwardArrayIterator.prototype.current=function(){if(this.$$index===this.$arrayLength)throw new Error("Call next() before current().");return this.$$array[this.$$index]},Iterable.prototype.reverse=function(){var that=this;return new Iterable(function(){var array,it=that.iterator();return it instanceof ArrayIterator?(array=it.getUnderlyingArray(),new BackwardArrayIterator(array)):(array=iteratorToArray(it),array.reverse(),new ArrayIterator(array))})},function(Iterable){var internalFirst=function(iterable,funcName,predOpt,$this){var options={func:void 0===predOpt?ALWAYS_TRUE_PREDICATE:predOpt,context:$this,funcArgName:"predOpt",methodName:funcName,iterable:iterable};return standardFunction(options,function(pred,iterable){for(var it=iterable.iterator(),index=0;it.next();){var curr=it.current();if(pred(curr,index))return{value:curr};index+=1}return null})};Iterable.prototype.first=function(predOpt,$this){var result=internalFirst(this,"first",predOpt,$this);if(result)return result.value;throw new Error(predOpt?"iter.first: sequence contains no elements satisfying the predicate.":"iter.first: sequence contains no elements.")},Iterable.prototype.firstOrDefault=function(defaultValue,predOpt,$this){var result=internalFirst(this,"firstOrDefault",predOpt,$this);return result?result.value:defaultValue}}(Iterable),function(Iterable){var internalLast=function(iterable,funcName,predOpt,$this){var options={func:void 0===predOpt?ALWAYS_TRUE_PREDICATE:predOpt,context:$this,funcArgName:"predOpt",methodName:funcName,iterable:iterable};return standardFunction(options,function(pred,iterable){for(var it=iterable.iterator(),index=0,lastValue=null;it.next();){var curr=it.current();pred(curr,index)&&(lastValue={value:curr}),index+=1}return lastValue})};Iterable.prototype.last=function(predOpt,$this){var result=internalLast(this,"last",predOpt,$this);if(result)return result.value;throw new Error(predOpt?"iter.last: sequence contains no elements statisfying the predicate.":"iter.last: sequence contains no elements.")},Iterable.prototype.lastOrDefault=function(defaultValue,predOpt,$this){var result=internalLast(this,"lastOrDefault",predOpt,$this);return result?result.value:defaultValue}}(Iterable),Iterable.prototype.groupBy=function(){var addValueToGrouping=function(groupping,key,value){var group=groupping.get(key);group?group.push(value):groupping.put(key,[value])},createKeySelector=function(selectors){return function(obj){for(var subkey,key=[],i=0;i<selectors.length;i+=1)subkey=selectors[i](obj),key.push(subkey);return key}},grouppingToArray=function(groupping,isSingleSelectorKey){for(var result=[],keyGroupPairs=groupping.toArray(),i=0;i<keyGroupPairs.length;i+=1){var groupElements=iter(keyGroupPairs[i].value);groupElements.key=isSingleSelectorKey?keyGroupPairs[i].key[0]:keyGroupPairs[i].key,result.push(groupElements)}return result},createSelector=function(selector){return throwIfNotQuickOrFunction(selector,"arguments","groupBy"),isQuick(selector)&&(selector=quickToFunction(selector)),selector};return function(){if(0===arguments.length)throw new Error("iter.groupBy: specify at least one property selector.");for(var selectors=toArray(arguments),i=0;i<selectors.length;i+=1)selectors[i]=createSelector(selectors[i]);var keySelector=createKeySelector(selectors),isSingleSelectorKey=1===selectors.length,that=this;return new Iterable(function(){for(var groupping=new ArrayKeyHashtable,it=that.iterator();it.next();){var curr=it.current(),key=keySelector(curr);addValueToGrouping(groupping,key,curr)}var result=grouppingToArray(groupping,isSingleSelectorKey);return new ArrayIterator(result)})}}(),Iterable.prototype.random=function(){var current,it=this.iterator(),index=1;if(!it.next())throw new Error("iter.random: sequence contains no elements.");do Math.random()<1/index&&(current=it.current()),index+=1;while(it.next());return current},Iterable.prototype.orderBy=function(){var comparerFactories,resetComparerFactories=function(){comparerFactories=Object.create(null),addComparerFactory("",function(selector){return function(left,right){var leftProp=selector(left),rightProp=selector(right);return rightProp>leftProp?-1:leftProp===rightProp?0:1}}),addComparerFactory("localeCompare",function(selector){return function(left,right){var leftProp=String(selector(left)),rightProp=String(selector(right));return leftProp.localeCompare(rightProp)}})},addComparerFactory=function(comparerName,factory){if(!isString(comparerName))throw new TypeError("iter.orderBy: comparer name must be a string.");if(comparerName&&!isJSIdentifier(comparerName))throw new Error("iter.orderBy: invalid comparer name.");if(!isFunction(factory))throw new TypeError("iter.orderBy: factory must be a function.");comparerFactories[comparerName+"$"]=factory},hasComparerFactory=function(comparerName){return Object.prototype.hasOwnProperty.call(comparerFactories,comparerName+"$")};resetComparerFactories();var createComparerUsingFactory=function(comparerName,selector){if(!hasComparerFactory(comparerName))throw new Error('iter.orderby: comparer with name "'+comparerName+'" is not registered.');var factory=comparerFactories[comparerName+"$"];return factory(selector)},trimEnd=function(str){return str.replace(/\s*$/,"")},endsWith=function(str,ending){return str.lastIndexOf(ending)===str.length-ending.length?!0:!1},removeLastCharacters=function(str,lastCharsCount){return str.length<lastCharsCount?"":str.slice(0,str.length-lastCharsCount)},parseSelector=function(orderByQuick){if(!isString(orderByQuick))return null;var result={},q=trimEnd(orderByQuick);if(endsWith(q,"@desc")?(q=removeLastCharacters(q,"@desc".length),result.desc=!0):endsWith(q,"@asc")&&(q=removeLastCharacters(q,"@asc".length),result.desc=!1),q=trimEnd(q),/@[a-zA-Z0-9$]+$/.test(q)){var atIndex=q.lastIndexOf("@"),comparerName=q.slice(atIndex);q=q.slice(0,atIndex),result.comparerName=comparerName.slice(1)}else result.comparerName="";return result.quick=q,result},reverseComparer=function(comparer){return function(left,right){return-comparer(left,right)}},createComparer=function(selector){if(isFunction(selector))return createComparerUsingFactory("",selector);var parsedSelector=parseSelector(selector);if(!parsedSelector)throw new Error('iter.orderBy: invalid property selector: "'+selector+'".');selector=quickToFunction(parsedSelector.quick);var comparer=createComparerUsingFactory(parsedSelector.comparerName,selector);return parsedSelector.desc&&(comparer=reverseComparer(comparer)),comparer},createMultiComparer=function(){var comparers=toArray(arguments);return function(left,right){for(var i=0;i<comparers.length;i+=1){var cmp=comparers[i](left,right);if(0!==cmp)return cmp}return 0}};return function(){var selectors=toArray(arguments);if(0===selectors.length)throw new Error("iter.orderBy: specify at least one property selector.");for(var comparers=[],i=0;i<selectors.length;i+=1)comparers[i]=createComparer(selectors[i]);var multiComparer=1===comparers.length?comparers[0]:createMultiComparer.apply(null,comparers),that=this;return new Iterable(function(){var data=that.toArray();return data.sort(multiComparer),new ArrayIterator(data)})}}(),function(Iterable){var internalOne=function(iterable,funcName,predOpt,$this){var options={func:void 0===predOpt?ALWAYS_TRUE_PREDICATE:predOpt,context:$this,funcArgName:"predOpt",methodName:funcName,iterable:iterable};return standardFunction(options,function(pred,iterable){for(var it=iterable.iterator(),index=-1,one=null;it.next();){index+=1;var curr=it.current();if(pred(curr,index)){if(one)throw new Error("iter."+funcName+": sequence contains more than one matching element.");one={value:curr}}}return one})};Iterable.prototype.one=function(predOpt,$this){var result=internalOne(this,"one",predOpt,$this);if(result)return result.value;throw new Error(predOpt?"iter.one: sequence contains no elements satisfying the predicate.":"iter.one: sequence contains no elements.")},Iterable.prototype.oneOrDefault=function(defaultValue,predOpt,$this){var result=internalOne(this,"oneOrDefault",predOpt,$this);return result?result.value:defaultValue}}(Iterable),Iterable.prototype.materialize=function(){var materializedData=this.toArray();return new Iterable(function(){return new ArrayIterator(materializedData)})},Iterable.prototype.isEmpty=function(){var it=this.iterator();return it.next()?!1:!0};var iter=global.iter=function(obj){if(isArray(obj))return new Iterable(function(){return new ArrayIterator(obj)});if(isObject(obj))return new Iterable(function(){return new ObjectIterator(obj)});if(isFunction(obj))return new Iterable(function(){return new FunctionIterator(obj)});throw new Error("iter: Only arrays, object and functions can be iterated.")},toIterable=function(obj){return obj instanceof Iterable?obj:iter(obj)};iter.Iterable=Iterable,iter.range=function(){var argsLenght=arguments.length,args=Array.prototype.slice.call(arguments);if(2!==argsLenght&&3!==argsLenght)throw new Error("iter.range: Invalid range arguments. Use range(from, to) or range(from, step, to).");var hasStep=3===argsLenght,from=Number(args[0]),to=Number(hasStep?args[2]:args[1]);if(!isFinite(from))throw new Error("iter.range: from must be a finite number.");if(!isFinite(to))throw new Error("iter.range: to must be a finite number.");var step;if(to>=from){if(step=hasStep?args[1]:1,0>=step)throw new Error("iter.range: step must be a positive number.")}else if(step=hasStep?args[1]:-1,step>=0)throw new Error("iter.range: step must be a negative number.");if(!isFinite(step))throw new Error("iter.range: step must be finite number.");var index=0;return iter(step>=0?function(){var next=from+index*step;return next>=to?void 0:(index+=1,next)}:function(){var next=from+index*step;return to>=next?void 0:(index+=1,next)})};var EMPTY_ITERATOR_FUNCTION=function(){return void 0};iter.empty=function(){return iter(EMPTY_ITERATOR_FUNCTION)},iter.quick=function(parameters,expression,options){var args=toArray(arguments);if(1===args.length&&(parameters=["$"],expression=args[0],options={}),!isArray(parameters))throw new Error('iter.quick: parameters should be passed as array of identifiers e.g. iter.quick(["$"], "$ > 3")');for(var i=0;i<parameters.length;i+=1)if(!isJSIdentifier(parameters[i]))throw new Error('iter.quick: invalid JavaScript parameter name: "'+parameters[i]+'"');if(!isQuick(expression))throw new Error("iter.quick: invalid or missing expression argument");return options=options||{},quickToFunction(expression,{result:QUICK_RESULT.ANY,parameters:parameters})},iter.zipWith=function(){var ZipWithIterator=function(leftIterator,rightIterator,mergeFunction){this.$$left=leftIterator,this.$$right=rightIterator,this.$$mergeFunction=mergeFunction,this.$$end=!1};return ZipWithIterator.prototype.next=function(){if(this.$$end)return!1;if(!this.$$left.next()||!this.$$right.next())return this.$$end=!0,!1;var curr=this.$$mergeFunction(this.$$left.current(),this.$$right.current());return this.$$current={value:curr},!0},ZipWithIterator.prototype.current=function(){if(this.$$current)return this.$$current.value;throw new Error("Iterator.current: call next() before current().")},function(leftIterable,rightIterable,mergeFunction,$this){if(arguments.length<3)throw new Error("iter.zipWith: missing arguments. To merge two iterables use syntax iter.zip(leftIterable, rightIterable, mergeFunction);");leftIterable=toIterable(leftIterable),rightIterable=toIterable(rightIterable);var options={func:mergeFunction,funcParams:["$left","$right"],funcResult:QUICK_RESULT.ANY,context:$this,funcArgName:"mergeFunction",methodName:"iter.zipWith"};return standardFunction(options,function(mergeFunction){return new Iterable(function(){var leftIterator=leftIterable.iterator(),rightIterator=rightIterable.iterator();return new ZipWithIterator(leftIterator,rightIterator,mergeFunction)})})}}(),iter.concat=function(){var ConcatIterator=function(iterators){this.$$iterators=iterators,this.$$currentIterator=0};return ConcatIterator.prototype.next=function(){for(;this.$$currentIterator<this.$$iterators.length&&!this.$$iterators[this.$$currentIterator].next();)this.$$currentIterator+=1;if(this.$$currentIterator<this.$$iterators.length){var curr=this.$$iterators[this.$$currentIterator].current();return this.$$current={value:curr},!0}return!1},ConcatIterator.prototype.current=function(){if(this.$$current)return this.$$current.value;throw new Error("Iterator.current: call next() before call to current().")},function(){var iterables=toArray(arguments);return iterables.length?new Iterable(function(){var iterators=iterables.map(function(x){return toIterable(x).iterator()});return new ConcatIterator(iterators)}):iter.empty()}}(),iter.interleave=function(){var InterleaveIterator=function(iterators){this.$$iterators=iterators,this.$$currentIterator=-1};return InterleaveIterator.prototype.next=function(){for(;this.$$iterators.length;){for(this.$$currentIterator+=1;this.$$currentIterator>=this.$$iterators.length;)this.$$currentIterator-=this.$$iterators.length;if(this.$$iterators[this.$$currentIterator].next())return this.$$current={value:this.$$iterators[this.$$currentIterator].current()},!0;this.$$iterators.splice(this.$$currentIterator,1)}return!1},InterleaveIterator.prototype.current=function(){if(this.$$current)return this.$$current.value;throw new Error("Iterator.current: call next() before call to current().")},function(){var iterables=toArray(arguments);if(iterables.length)return new Iterable(function(){var iterators=iterables.map(function(x){return toIterable(x).iterator()});return new InterleaveIterator(iterators)});throw new Error("iter.interleave: missing argument, specify at least one iterable.")}}()}("undefined"==typeof window?global:window);